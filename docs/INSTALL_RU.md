---
title: "Установка"
weight: 15
---

# Требования к DVP

## Требования к ресурсам:

Рекомендуются следующие минимальные ресурсы для инфраструктурных узлов в зависимости от их роли в кластере:

- Мастер-узел — 4 CPU, 8 ГБ RAM, 60 ГБ дискового пространства на быстром диске (400+ IOPS);
- Worker-узел — требования аналогичны требованиям к master-узлу, но во многом зависят от характера запускаемой на узле (узлах) нагрузки.

## Требования к узлам платформы:

- ОС на базе Linux:
  - РЕД ОС 7.3, 8.0
  - РОСА Сервер 7.9, 12.4, 12.5.1
  - ALT Linux p10, 10.0, 10.1, 10.2, 11
  - Astra Linux Special Edition 1.7.2, 1.7.3, 1.7.4, 1.7.5
  - CentOS 7, 8, 9
  - Debian 10, 11, 12
  - Rocky Linux 8, 9
  - Ubuntu 18.04, 20.04, 22.04, 24.04
- Версия ядра Linux >= 5.7
- ЦП с архитектурой x86_64 c с поддержкой инструкций Intel-VT (vmx) или AMD-V (svm)

# Порядок установки

1. Разверните кластер Deckhouse Kubernetes Platform по [инструкции](https://deckhouse.ru/gs/).

2. Включите необходимые модули.

   Для хранения данных виртуальных машин (виртуальные диски и образы) необходимо включить один или несколько из следующих модулей согласно инструкции по их установке:

   - [SDS-Replicated-volume](https://deckhouse.ru/modules/sds-replicated-volume/stable/)
   - [SDS-Local-volume](https://deckhouse.ru/modules/sds-local-volume/stable/)
   - [CSI-nfs](https://deckhouse.ru/modules/csi-nfs/stable/)
   - [CEPH-CSI](/documentation/v1/modules/031-ceph-csi/)

3. [Установите](https://kubernetes.io/docs/tasks/administer-cluster/change-default-storage-class/) `StorageClass` по умолчанию.
4. Включите модуль [console](https://deckhouse.ru/modules/console/stable/), который позволит управлять компонентами виртуализации через графический интерфейс (Данная возможность доступна только пользователям EE-редакции).

5. Включите модуль `virtualization`:

{{< alert level="warning" >}}
Внимание! Включение модуля `virtualization` предполагает рестарт kubelet\containerd на всех узлах, где предполагается запуск виртуальных машин. Это необходимо для настройки связности containerd и DVCR.
{{< /alert >}}

Для включения модуля `virtualization`, необходимо создать ресурс `ModuleConfig`, содержащий настройки модуля.

{{< alert level="info" >}}
Полный перечень параметров конфигурации приведен в разделе ["Настройки"](./configuration.html)
{{< /alert >}}

Пример конфигурации модуля:

```yaml
d8 k apply -f - <<EOF
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: virtualization
spec:
  enabled: true # включить модуль
  settings:
    dvcr:
      storage:
        persistentVolumeClaim:
          size: 50G
        type: PersistentVolumeClaim
    virtualMachineCIDRs:
      - 10.66.10.0/24
  version: 1
EOF
```

Блок `.spec.settings.dvcr` описывает настройки для репозитория для хранения образов виртуальных машин, в данном блоке указывается размер хранилища предоставляемого для хранения образов `.spec.settings.dvcr.storage.persistentVolumeClaim.size`. В блоке `.spec.settings.virtualMachineCIDRs` задается список подсетей. Адреса виртуальных машин будут выделятся автоматически или по по запросу из заданных диапазонов подсетей по порядку.

Отследить готовность модуля можно с использованием следующей команды:

```bash
d8 k get modules virtualization
# NAME             WEIGHT   STATE     SOURCE     STAGE   STATUS
# virtualization   900      Enabled   Embedded           Ready
```

Статус модуля должен быть `Ready`.

# Обновление платформы

Deckhouse Virtualization Platform использует пять каналов обновлений предназначенных для использования в разных окружениях, к которым с точки зрения надежности применяются разные требования:

| Канал обновлений | Описание                                                                                                                                                                                                                                                                                          |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Alpha            | Наименее стабильный канал обновлений с наиболее частым появлением новых версий. Ориентирован на кластеры разработки с небольшим количеством разработчиков.                                                                                                                                        |
| Beta             | Ориентирован на кластеры разработки, как и канал обновлений Alpha. Получает версии, предварительно опробованные на канале обновлений Alpha.                                                                                                                                                       |
| Early Access     | Рекомендуемый канал обновлений, если вы не уверены в выборе. Подойдет для кластеров, в которых идет активная работа (запускаются, дорабатываются новые приложения и т. п.). Обновления функционала до этого канала обновлений доходят не ранее чем через одну неделю после их появления в релизе. |
| Stable           | Стабильный канал обновлений для кластеров, в которых закончена активная работа и преимущественно осуществляется эксплуатация. Обновления функционала до этого канала обновлений доходят не ранее чем через две недели после их появления в релизе.                                                |
| Rock Solid       | Наиболее стабильный канал обновлений. Подойдет для кластеров, которым необходимо обеспечить повышенный уровень стабильности. Обновления функционала до этого канала доходят не ранее чем через месяц после их появления в релизе.                                                                 |

Компоненты Deckhouse Virtualization Platform могут обновляться автоматически, либо с ручным подтверждением по мере выхода обновлений в каналах обновления.

Информацию по версиям, доступных на каналах обновления можно получить на данном сайте https://releases.deckhouse.ru/
