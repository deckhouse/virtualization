apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: virtualmachinedisksnapshots.virtualization.deckhouse.io
  labels:
    heritage: deckhouse
    module: virtualization
spec:
  group: virtualization.deckhouse.io
  scope: Namespaced
  names:
    plural: virtualmachinedisksnapshots
    singular: virtualmachinedisksnapshot
    kind: VirtualMachineDiskSnapshot
  preserveUnknownFields: false
  versions:
    - name: v2alpha1
      served: true
      storage: true
      schema:
        openAPIV3Schema:
          type: object
          description: |
            Describes a virtual machine disk snapshot.
          required:
            - spec
          properties:
            spec:
              type: object
              required:
                - virtualMachineDiskName
              properties:
                virtualMachineDiskName:
                  type: string
                  description: |
                    Name of the `VirtualMachineDisk` from which the snapshot will be created
            status:
              type: object
              properties:
                size:
                  type: string
                  description: |
                    The size of disk snapshot.
                volumeSnapshotName:
                  type: string
                  description: |
                    The name of `VolumeSnapshot` resource where snapshot is located.
                phase:
                  type: string
                  enum: ['Pending', 'Provisioning', 'Ready', 'Failed']
                failureReason:
                  type: string
                  description: |
                    A brief description of the cause of the error.
                failureMessage:
                  type: string
                  description: |
                    Detailed description of the error.
      additionalPrinterColumns:
      - name: Phase
        type: string
        jsonPath: .status.phase
      - name: Size
        type: string
        jsonPath: .status.size
      subresources:
        status: {}
