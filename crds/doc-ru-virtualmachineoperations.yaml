spec:
  versions:
    - name: v1alpha2
      schema:
        openAPIV3Schema:
          description: |
            Данный ресурс позволяет декларативно управлять изменением состояний виртуальных машин (ВМ).
          properties:
            spec:
              properties:
                type:
                  description: |
                    Операции над виртуальной машиной:

                    * `Start` — запустить виртуальную машину;
                    * `Stop` — остановить виртуальную машину;
                    * `Restart` — перезапустить виртуальную машину;
                    * `Migrate` — мигрировать виртуальную машину на другой узел, доступный для запуска данной ВМ;
                    * `Evict` — выселить виртуальную машину на другой узел, доступный для запуска данной ВМ;
                    * `Restore` — восстановить виртуальную машину из снимка;
                    * `Clone` — клонировать виртуальную машину.
                virtualMachineName:
                  description: |
                    Имя виртуальной машины, для которой выполняется операция.
                force:
                  description: |
                    Форсирует выполнение операции.

                    * Для операций `Restart` и `Stop`: выполнить операцию немедленно.
                    * Для операции `Evict` и `Migrate`: включить функцию AutoConverge для принудительной миграции через замедление CPU, если для живой миграции используются политики `PreferSafe` или `PreferForced`.
                restore:
                  description: |
                    Определяет операцию восстановления из снимка.
                  properties:
                    mode:
                      description: |
                        Режим восстановления:

                        * `DryRun` — запуск без выполнения восстановления. Конфликты и несоответствия фиксируются в статусе операции.
                        * `Strict` — строгий режим восстановления «как в снимке». Отсутствие внешних зависимостей может привести к тому, что виртуальная машина после восстановления будет находиться в состоянии `Pending`;
                        * `BestEffort` — режим восстановления с удалением отсутствующих внешних зависимостей (ClusterVirtualImage, VirtualImage, Secret) из спецификации виртуальной машины.
                    virtualMachineSnapshotName:
                      description: |
                        Имя снимка виртуальной машины, который используется как источник для операции восстановления.
                migrate:
                  description: |
                    Определяет операцию миграции виртуальной машины.
                  properties:
                    nodeSelector:
                      description: |-
                        NodeSelector должен соответствовать меткам узла, чтобы виртуальная машина была запланирована на этом узле.
                        [По аналогии](https://kubernetes.io/docs/tasks/configure-pod-container/assign-pods-nodes/) c параметром подов `spec.nodeSelector` в Kubernetes.
                clone:
                  description: |
                    Определяет операцию клонирования.
                  properties:
                    mode:
                      description: |
                        Режим клонирования:

                        * `DryRun` — запуск без выполнения клонирования. Конфликты и несоответствия фиксируются в статусе операции.
                        * `Strict` — строгий режим клонирования «как в исходной ВМ». Отсутствие внешних зависимостей может привести к тому, что клонированная виртуальная машина после создания будет находиться в состоянии `Pending`;
                        * `BestEffort` — режим клонирования с удалением отсутствующих внешних зависимостей (ClusterVirtualImage, VirtualImage) из спецификации виртуальной машины.
                    customization:
                      description: |
                        Определяет параметры кастомизации для клонирования.
                      properties:
                        namePrefix:
                          description: |
                            Добавляет префикс к именам ресурсов при клонировании.
                            Применяется к ресурсам VirtualMachine, VirtualDisk, VirtualMachineBlockDeviceAttachment и Secret.
                        nameSuffix:
                          description: |
                            Добавляет суффикс к именам ресурсов при клонировании.
                            Применяется к ресурсам VirtualMachine, VirtualDisk, VirtualMachineBlockDeviceAttachment и Secret.
                    nameReplacement:
                      description: |
                        Определяет правила переименования ресурсов при клонировании.
                      items:
                        description: |
                          Представляет правило для переопределения имён ресурсов виртуальной машины.
                        properties:
                          from:
                            description: |
                              Селектор для выбора ресурсов для переименования.
                            properties:
                              kind:
                                description: |
                                  Тип ресурса для переименования.
                              name:
                                description: |
                                  Текущее имя ресурса для переименования.
                          to:
                            description: |
                              Новое имя ресурса.
            status:
              properties:
                conditions:
                  description: |
                    Последнее подтверждённое состояние данного ресурса.
                  items:
                    description: |
                      Подробные сведения об одном аспекте текущего состояния данного API-ресурса.
                    properties:
                      lastTransitionTime:
                        description: Время перехода условия из одного состояния в другое.
                      message:
                        description: Удобочитаемое сообщение с подробной информацией о последнем переходе.
                      observedGeneration:
                        description: |
                          `.metadata.generation`, на основе которого было установлено условие.
                          Например, если `.metadata.generation` в настоящее время имеет значение `12`, а `.status.conditions[x].observedgeneration` имеет значение `9`, то условие устарело.
                      reason:
                        description: Краткая причина последнего перехода состояния.
                      status:
                        description: |
                          Статус условия. Возможные значения: `True`, `False`, `Unknown`.
                      type:
                        description: Тип условия.
                phase:
                  description: |
                    Представляет текущее состояние ресурса:

                    * `Pending` — операция поставлена в очередь на выполнение;
                    * `InProgress` — операция в процессе выполнения;
                    * `Completed` — операция прошла успешно;
                    * `Failed` — операция завершилась неудачно. За подробностями обратитесь к полю `conditions` и событиям;
                    * `Terminating` — операция удаляется.
                observedGeneration:
                  description: |
                    Поколение ресурса, которое в последний раз обрабатывалось контроллером.
                resources:
                  description: |
                    Содержит список ресурсов, затронутых операцией снимка.
                  items:
                    description: |
                      Определяет ресурс, затронутый операцией.
                    properties:
                      apiVersion:
                        description: API версия ресурса.
                      kind:
                        description: Тип ресурса.
                      message:
                        description: Сообщение о ресурсе.
                      name:
                        description: Имя ресурса.
                      status:
                        description: Статус ресурса.
