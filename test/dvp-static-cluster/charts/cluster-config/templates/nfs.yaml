{{- if eq .Values.deckhouse.bundle "Default" }}
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: csi-nfs
spec:
  enabled: true
  source: deckhouse
  version: 1
---
apiVersion: deckhouse.io/v1alpha2
kind: ModulePullOverride
metadata:
  name: csi-nfs
spec:
  imageTag: main
  scanInterval: 10m
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: snapshot-controller
spec:
  enabled: true
  version: 1
---
apiVersion: storage.deckhouse.io/v1alpha1
kind: NFSStorageClass
metadata:
  name: nfs
spec:
  connection:
    host: {{ include "cluster-config.full-svc-address" (list $ "nfs-server") }}
    share: /
    nfsVersion: "4.1"
  mountOptions:
    mountMode: hard
    timeout: 60
    retransmissions: 3
  reclaimPolicy: Delete
  volumeBindingMode: WaitForFirstConsumer
{{ end -}}
