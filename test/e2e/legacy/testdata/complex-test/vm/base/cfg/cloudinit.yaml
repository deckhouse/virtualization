#cloud-config
users:
  - name: cloud
    # passwd: cloud
    passwd: $6$rounds=4096$vln/.aPHBOI7BMYR$bBMkqQvuGs5Gyd/1H5DP4m9HjQSy.kgrxpaGEHwkX7KEFV8BS.HZWPitAtZ2Vd8ZqIZRqmlykRCagTgPejt1i.
    shell: /bin/bash
    sudo: ALL=(ALL) NOPASSWD:ALL
    lock_passwd: false
    ssh_authorized_keys:
      # testcases
      - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFxcXHmwaGnJ8scJaEN5RzklBPZpVSic4GdaAsKjQoeA your_email@example.com
runcmd:
  - systemctl enable qemu-guest-agent.service
  - systemctl start qemu-guest-agent.service
  - |
    if systemctl is-active --quiet qemu-guest-agent.service; then
      echo "✓ QEMU Guest Agent is RUNNING" | tee /var/log/qemu-ga-status.log
      systemctl status qemu-guest-agent.service --no-pager | tee -a /var/log/qemu-ga-status.log
    else
      echo "✗ QEMU Guest Agent FAILED to start" | tee /var/log/qemu-ga-status.log
    fi
final_message: "\U0001F525\U0001F525\U0001F525 The system is finally up, after $(awk '{print int($1)}' /proc/uptime) seconds \U0001F525\U0001F525\U0001F525"
