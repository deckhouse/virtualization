---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: deckhouse
spec:
  version: 1
  enabled: true
  settings:
    bundle: Default
    logLevel: Info
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: global
spec:
  version: 1
  settings:
    defaultClusterStorageClass: {{ .Values.storageClass | quote }}
    modules:
      publicDomainTemplate: "%s.{{ .Values.namespace }}.{{ .Values.domain }}"
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: user-authn
spec:
  version: 1
  enabled: true
  settings:
    controlPlaneConfigurator:
      dexCAMode: DoNotNeed
    publishAPI:
      enabled: true
      https:
        mode: Global
        global:
          kubeconfigGeneratorMasterCA: ""
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: cni-cilium
spec:
  version: 1
  enabled: true
  settings:
    tunnelMode: VXLAN
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: snapshot-controller
spec:
  version: 1
  enabled: true
---
apiVersion: deckhouse.io/v1alpha2
kind: ModulePullOverride
metadata:
  name: snapshot-controller
spec:
  imageTag: main
  scanInterval: 15s
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: virtualization
spec:
  version: 1
  enabled: true
  settings:
    dvcr:
      storage:
        persistentVolumeClaim:
          size: 10Gi
        type: PersistentVolumeClaim
    virtualMachineCIDRs:
      - 192.168.10.0/24
---
apiVersion: deckhouse.io/v1alpha2
kind: ModulePullOverride
metadata:
  name: virtualization
spec:
  imageTag: {{ .Values.virtualization.tag }}
  scanInterval: 15s
