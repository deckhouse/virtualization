{{- $cephEnabled := true -}}
{{- if hasKey .Values "features" -}}
  {{- $cephEnabled = (hasKey .Values.features "ceph") | ternary .Values.features.ceph true -}}
{{- end -}}
{{- if $cephEnabled }}
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: operator-ceph
spec:
  enabled: true
  version: 1
---
apiVersion: deckhouse.io/v1alpha2
kind: ModulePullOverride
metadata:
  name: operator-ceph
spec:
  imageTag: {{ .Values.ceph.tag | default .Values.deckhouse.tag }}
  scanInterval: 15s
---
apiVersion: deckhouse.io/v1alpha1
kind: ModuleConfig
metadata:
  name: csi-ceph
spec:
  enabled: true
  version: 1
---
apiVersion: deckhouse.io/v1alpha2
kind: ModulePullOverride
metadata:
  name: csi-ceph
spec:
  imageTag: {{ .Values.ceph.tag | default .Values.deckhouse.tag }}
  scanInterval: 15s
{{- end }}

