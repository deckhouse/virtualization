package humanize

import (
	"math"
	"testing"
)

func Test_Humanize(t *testing.T) {
	tests := []struct {
		in  int64
		out string
	}{
		{
			0,
			"0",
		},
		{
			10,
			"10",
		},
		{
			1024,
			"1.00Ki",
		},
		{
			1024 * 1024,
			"1.00Mi",
		},
		{
			2*1024*1024 + 2*1024,
			"2.00Mi",
		},
		{
			2*1024*1024 + 20*1024,
			"2.02Mi",
		},
		{
			2*1024*1024 + 200*1024,
			"2.20Mi",
		},
		{
			32*1024*1024 + 2*1024,
			"32.0Mi",
		},
		{
			32*1024*1024 + 20*1024,
			"32.0Mi",
		},
		{
			32*1024*1024 + 200*1024,
			"32.2Mi",
		},
		{
			432*1024*1024 + 2*1024,
			"432Mi",
		},
		{
			432*1024*1024 + 20*1024,
			"432Mi",
		},
		{
			432*1024*1024 + 200*1024,
			"432Mi",
		},
		{
			1024 * 1024 * 1024,
			"1.00Gi",
		},
		{
			math.MaxInt64,
			"7.10Zi",
		},
		{
			-(1024 * 1024),
			"-1.00Mi",
		},
		{
			-(2*1024*1024 + 2*1024),
			"-2.00Mi",
		},
		{
			-(2*1024*1024 + 20*1024),
			"-2.02Mi",
		},
		{
			-(2*1024*1024 + 200*1024),
			"-2.20Mi",
		},
		{
			-(32*1024*1024 + 2*1024),
			"-32.0Mi",
		},
		{
			-(32*1024*1024 + 20*1024),
			"-32.0Mi",
		},
		{
			-(32*1024*1024 + 200*1024),
			"-32.2Mi",
		},
		{
			-(432*1024*1024 + 2*1024),
			"-432Mi",
		},
		{
			-(432*1024*1024 + 20*1024),
			"-432Mi",
		},
		{
			-(432*1024*1024 + 200*1024),
			"-432Mi",
		},
		{
			-(1024 * 1024 * 1024),
			"-1.00Gi",
		},
		{
			math.MinInt64,
			"-7.10Zi",
		},
	}

	for _, tt := range tests {
		t.Run(tt.out, func(t *testing.T) {
			actual := humanizeQuantity4(tt.in, BIBase)
			if tt.out != actual {
				t.Fatalf("expect '%s' quantity for %d, got '%s'", tt.out, tt.in, actual)
			}
		})
	}
}
